/* Form Submission Validation (IE 9+) https://github.com/davidbowland/form-submit */"use strict";var formSubmit=new function(){var a=this,b="Invalid input",c=0,d={},e={},f={m:"(1[0-2]|0?[1-9])",mm:"(0[1-9]|1[0-2])",d:"([12]\\d|3[01]|0?[1-9])",dd:"(0[1-9]|[12]\\d|3[01])",yy:"(\\d\\d)",yyyy:"((?:19|20)\\d\\d)",H:"(1[0-2]|0?[1-9])",HH:"(0[1-9]|1[0-2])",H24:"(1\\d|2[0-3]|0?\\d)",HH24:"(0\\d|1\\d|2[0-3])",M:"((?:0|[1-5])?\\d)",MM:"([0-5]\\d)",S:"((?:0|[1-5])?\\d)",SS:"([0-5]\\d)",MS:"(\\d{1,6})"},g={0:"\\d",9:"[1-9]"},h={digits:"0",number:"0.0",currency:"0.00",phone:"(000)000-0000",zip:"00000",email:"user@domain.com",timestamp:"mm/dd/yyyy hh:mm:ss.ms","date-mmddyyyy":"mm/dd/yyyy","date-yyyymmdd":"yyyy-mm-dd",time:"hh:mm"};a.addValidation=function(b,c){return a.removeValidation(b),d[l(b)]=c,b.addEventListener("change",n),b.addEventListener("blur",n),j(b.form),a},a.removeValidation=function(b){return b.removeEventListener("change",n),b.removeEventListener("blur",n),delete d[l(b)],k(b.form),a.removeErrorMessage(b),a},a.addRadioValidation=function(b,c){for(var e,d=b.form.querySelectorAll('[name="'+b.name+'"]'),f=0;e=d[f];f++)a.addValidation(e,c);return a},a.removeRadioValidation=function(b,c){for(var e,d=b.form.querySelectorAll('[name="'+b.name+'"]'),f=0;e=d[f];f++)a.removeValidation(e,c);return a},a.getErrorMessage=function(a){var e,b=d[l(a)],c=a.value;if("radio"==a.type.toLowerCase()?c=(e=a.form.querySelector('[name="'+a.name+'"]:checked'))?e.value:void 0:"SELECT"==a.tagName.toUpperCase()&&(c=a.querySelector(":checked").value),b)return b(c,a)},a.isValid=function(b){return!a.getErrorMessage(b)},a.displayErrorMessage=function(b,c){return a.removeErrorMessage(b),a.getErrorMessageElement(b).textContent=c,a},a.removeErrorMessage=function(b){return a.getErrorMessageElement(b).textContent="",a},a.getErrorMessageElement=function(a){var c,d,b=document.querySelector('[data-form-submit-error-for="'+(a.id||a.name)+'"]');return b||(b=document.createElement("span"),b.setAttribute("data-form-submit-error-for",a.id||a.name),"radio"==a.type.toLowerCase()?(c=a.form.querySelectorAll('[name="'+a.name+'"]'),d=c[c.length-1].nextElementSibling):d=a.nextElementSibling,a.parentElement.insertBefore(b,d)),b},a.addCounter=function(b,c){return a.removeCounter(b),void 0!==c?b.setAttribute("data-form-submit-count",c):isNaN(parseInt(b.getAttribute("data-form-submit-count")))&&b.setAttribute("data-form-submit-count",b.getAttribute("maxlength")),b.addEventListener("input",o),b.addEventListener("keypress",o),b.addEventListener("change",o),b.addEventListener("blur",o),o({currentTarget:b}),a},a.removeCounter=function(b){return b.removeEventListener("input",o),b.removeEventListener("keypress",o),b.removeEventListener("change",o),b.removeEventListener("blur",o),a.getCounterElement(b).textContent="",a},a.getCounterElement=function(a){var b=document.querySelector('[data-form-submit-counter-for="'+(a.id||a.name)+'"]');return b||(b=document.createElement("span"),b.setAttribute("data-form-submit-counter-for",a.id||a.name),a.parentElement.insertBefore(b,a.nextSibling)),b},a.unload=function(){var b,c,e=document.querySelectorAll("data-form-submit-count");for(c in d)a.removeValidation(d[c]);for(c=0;b=e[c];c++)a.removeCounter(b);return a},a.validation=new function(){var a=this;a.isDigits=function(a){return a.search(/^\d+$/)>=0},a.isNumber=function(a){return a.search(/^\-?((\d{1,3}(,?\d{3})*)\.?\d*|(\d{1,3}(,?\d{3})*)?\.\d+)$/)>=0},a.isCurrency=function(a){return a.search(/^\-?((\d{1,3}(,?\d{3})*)?\.\d\d)$/)>=0},a.isPhone=function(a,b,c){var d=(b||"(000)000-0000").replace(/0|9|.+?/g,function(a){return g[a]||(c?"\\D*?":a.replace(/(\W)/g,"\\$1"))});return new RegExp("^"+d+"$").test(a)},a.isZip=function(a){return a.search(/^\d{5}$/)>=0},a.isEmail=function(a){return a.search(/^.+@([a-z0-9]([a-z0-9-]*[a-z0-9])*\.)+[a-z]+$/i)>=0},a.isTimestamp=function(a,b,d){return c(b||"mm/dd/yyyy HH:MM:SS.MS",d).test(a)},a.isDate=function(b,c,d){return a.isTimestamp(b,c||"mm/dd/yyyy",d)},a.isTime=function(b,c,d){return a.isTimestamp(b,c||"HH24:MM",d)},a.formatDigits=function(a,b){var d,c=a.match(/\d/g)||[];return void 0!==b&&a?b.replace(/\d/g,function(a,b){return c.length?c.shift():(void 0===d&&(d=b),"")}).slice(0,d):c.join("")},a.formatNumber=function(a){var c=0,d=a.indexOf("-")>=0?"-":"";return b(d+a.replace(/\D/g,function(a){return"."==a&&1==++c?".":""}))},a.formatCurrency=function(c){return c=a.formatNumber(c),c?b(parseFloat(c.replace(/,/g,"")).toFixed(2)):c},a.formatPhone=function(b,c){return a.formatDigits(b,c||"(000)000-0000")},a.formatZip=function(b,c){return a.formatDigits(b,c||"00000")},a.formatTimestamp=function(a,b){var d,e,f={},g=void 0;if(b=b||"mm/dd/yyyy HH:MM:SS.MS",!a)return"";if(d=c(b.replace(/mm|dd|HH|MM|SS/g,function(a){return a.slice(Math.min(a.length/-2))}),!0,!0).exec(a)){e=b.match(/mm|m|dd|d|yyyy|yy|HH|H|MS|MM|M|SS|S/g),d.shift();for(var h,i=0;h=d[i];i++)["mm","dd","HH24","HH","MM","SS"].indexOf(e[i])>=0&&(h=("00"+h).slice(-2)),f[e[i]]=h}else(d=a.match(/(?:^|\D)(1[0-2]|0?[1-9])([\\/-]?)([12]\d|3[01]|0?[1-9])(\2)((?:19|20)?\d\d)(?:\D|$)/))?(f.m=d[1],f.d=d[3],f.yy=d[5]):(d=a.match(/(?:^|\D)((?:19|20)?\d\d)([\\/-]?)(1[0-2]|0?[1-9])(\2)([12]\d|3[01]|0?[1-9])(?:\D|$)/))&&(f.yy=d[1],f.m=d[3],f.d=d[5]),d&&(d=a.slice(d[0].length).match(/(?:^|\D)(1\d|2[0-3]|0?\d)[\.:]?((?:0|[1-5])?\d)(?:[\.:]?((?:0|[1-5])?\d)(?:[\.:]?(\d{1,6}))?)?(?:\D|$)/))?(f.H=d[1],f.M=d[2],f.S=d[3],f.MS=d[4]):(d=a.match(/(?:^|\D)(1\d|2[0-3]|0?\d)[\.:]?((?:0|[1-5])?\d)(?:[\.:]?((?:0|[1-5])?\d)(?:[\.:]?(\d{1,6}))?)?(?:\D|$)/))&&(f.H=d[1],f.M=d[2],f.S=d[3],f.MS=d[4]);return["m","d","H","M","S"].forEach(function(a){var b=f[a];b&&(f[a]=b.match(/^0*(\d+)$/)[1],f[a+a]=("0"+b).slice(-2))}),f.yy&&(4==f.yy.length?(f.yyyy=f.yy,f.yy=f.yy.slice(-2)):f.yy<50?f.yyyy="20"+f.yy:f.yyyy="19"+f.yy),f.H&&(a.match(/p(\.?m)?/i)?f.H24=f.HH24=(parseInt(f.H)+12).toString():(f.H24=f.H,f.HH24=f.HH)),b.replace(/mm|m|dd|d|yyyy|yy|HH24|H24|HH|H|MS|MM|M|SS|S/g,function(a,b){return f[a]?f[a]:(void 0===g&&(g=b),"")}).slice(0,g)||a},a.formatDate=function(b,c){return a.formatTimestamp(b,c||"mm/dd/yyyy")},a.formatTime=function(b,c){return a.formatTimestamp(b,c||"HH24:MM")};var b=function(a){var b=a.match(/^([^\.]*)(\.?)([^\.]*)$/).slice(1);return b[0]=b[0].replace(/\B(?=(?:\d{3})+\b)/g,","),b.join("")},c=function(a,b,c){var g,h,d="",e="";if(c&&(g=a.match(/mm|m|dd|d|yyyy|yy|HH24|H24|HH|H|MS|MM|M|SS|S/g))){d="(?:";for(var i=0;g[i];i++)e+=")?"}return new RegExp("^"+a.replace(/mm|m|dd|d|yyyy|yy|HH24|H24|HH|H|MS|MM|M|SS|S|.+?/g,function(a){return(h=f[a])?d+h:b?"\\D?":a.replace(/(\W)/g,"\\$1")})+e+"$")}};var i=function(a,b){var c=a.getAttribute(b);return c&&"false"!=c.toLowerCase()},j=function(a){a in e||!a||(e[l(a)]=!0,a.addEventListener("submit",m))},k=function(a){var b,c;if(a){for(var c in d)if(b=d[c],b.form==a)return;a.removeEventListener("submit",m),delete e[l(a)]}},l=function(a){var b=parseInt(a.getAttribute("data-form-submit-id"));return isNaN(b)&&a.setAttribute("data-form-submit-id",b=c++),b},m=function(b){var c=b.currentTarget.querySelectorAll("[name]"),d=!0;if(i(b.currentTarget,"data-form-submit-always-allow"))return!0;for(var e,f,g=0;e=c[g];g++)(f=a.getErrorMessage(e))&&(a.displayErrorMessage(e,f),d&&(d=!1,e.focus()));return d||b.preventDefault(),d},n=function(b){var c;(c=a.getErrorMessage(b.currentTarget))?a.displayErrorMessage(b.currentTarget,c):a.removeErrorMessage(b.currentTarget)},o=function(b){var c=a.getCounterElement(b.currentTarget),d=b.currentTarget.getAttribute("data-form-submit-count");b.currentTarget.value=b.currentTarget.value.slice(0,parseInt(d)),c.textContent=b.currentTarget.value.length+"/"+d},p=function(a){return a.getAttribute("data-form-submit-error-msg")||b},q=function(b,c,d,e){a.addValidation(b,function(a,b){return c(b.value=d(a,e),e)?"":p(b)})},r=function(b,c,d,e){a.addValidation(b,function(a,b){return!c(b.value=d(a,e),e)&&b.value.length?p(b):""})},s=function(a,b){null===a.getAttribute("placeholder")&&a.setAttribute("placeholder",b)},t=function(c){var d,e,f,g,i,j;for(d=document.querySelectorAll("[data-form-submit-required]"),f=0;e=d[f];f++)if(g=e.getAttribute("data-form-submit-required"))switch(g=String(g).toLowerCase(),(j=h[g])&&s(e,j),g){case"digits":q(e,a.validation.isDigits,a.validation.formatDigits);break;case"number":q(e,a.validation.isNumber,a.validation.formatNumber);break;case"currency":q(e,a.validation.isCurrency,a.validation.formatCurrency);break;case"phone":q(e,a.validation.isPhone,a.validation.formatPhone);break;case"zip":q(e,a.validation.isZip,a.validation.formatZip);break;case"email":a.addValidation(e,function(b,c){return a.validation.isEmail(b)?"":p(c)});break;case"timestamp":q(e,a.validation.isTimestamp,a.validation.formatTimestamp);break;case"date-mmddyyyy":q(e,a.validation.isDate,a.validation.formatDate);break;case"date-yyyymmdd":q(e,a.validation.isDate,a.validation.formatDate,"yyyy-mm-dd");break;case"time":q(e,a.validation.isTime,a.validation.formatTime);break;case"radio":a.addRadioValidation(e,function(a,c){var d;return void 0===a?(d=c.form.querySelector('[name="'+c.name+'"][data-form-submit-error-msg]'),d?d.getAttribute("data-form-submit-error-msg"):b):""});break;case"false":break;default:a.addValidation(e,function(a,b){return a.length?"":p(b)})}for(d=document.querySelectorAll("[data-form-submit-optional]"),f=0;e=d[f];f++)if(g=e.getAttribute("data-form-submit-optional"))switch(g=String(g).toLowerCase(),(j=h[g])&&s(e,j),g){case"digits":r(e,a.validation.isDigits,a.validation.formatDigits);break;case"number":r(e,a.validation.isNumber,a.validation.formatNumber);break;case"currency":r(e,a.validation.isCurrency,a.validation.formatCurrency);break;case"phone":r(e,a.validation.isPhone,a.validation.formatPhone);break;case"zip":r(e,a.validation.isZip,a.validation.formatZip);break;case"email":a.addValidation(e,function(b,c){return!b||a.validation.isEmail(b)?"":p(c)});break;case"timestamp":r(e,a.validation.isTimestamp,a.validation.formatTimestamp);break;case"date-mmddyyyy":r(e,a.validation.isDate,a.validation.formatDate);break;case"date-yyyymmdd":r(e,a.validation.isDate,a.validation.formatDate,"yyyy-mm-dd");break;case"time":r(e,a.validation.isTime,a.validation.formatTime);break;case"false":break;default:console.log("data-form-submit-optional invalid: "+e.getAttribute("data-form-submit-optional"))}for(d=document.querySelectorAll("[data-form-submit-regex]"),f=0;e=d[f];f++)a.addValidation(e,function(a,b){try{var c=new RegExp("^"+b.getAttribute("data-form-submit-regex").match(/^\^*(.*?)\$*$/)[1]+"$")}catch(a){throw console.log("data-form-submit-regex invalid: "+b.getAttribute("data-form-submit-regex")),a}return c.test(a)?"":p(b)});for(d=document.querySelectorAll("[data-form-submit-count]"),f=0;e=d[f];f++)i=e.getAttribute("data-form-submit-count"),"true"!=i&&isNaN(parseInt(i))&&console.log("data-form-submit-count invalid: "+e.getAttribute("data-form-submit-count")),a.addCounter(e)};document.addEventListener("DOMContentLoaded",t,!0),t()};